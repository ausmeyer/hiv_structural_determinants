getwd()
source('~/Desktop/hiv/hiv_structure/predictors/calc_correlations.R')
source('~/Desktop/hiv/hiv_structure/predictors/calc_correlations.R')
source('~/Desktop/hiv/hiv_structure/predictors/calc_correlations.R')
source('~/Desktop/hiv/hiv_structure/predictors/calc_correlations.R')
cor(dN.dS, predict(lm(dN.dS[x!=0] ~ 1/x[x!=0] + rsa[x!=0])))
k = distances[1,]
cor(dN.dS, predict(lm(dN.dS[k!=0] ~ 1/k[k!=0] + rsa[k!=0])))
dim(rsa)
rsa
length(rsa)
length(k)
length(dN.dS)
lm(dN.dS[k!=0] ~ 1/k[k!=0] + rsa[k!=0])
predict(lm(dN.dS[k!=0] ~ 1/k[k!=0] + rsa[k!=0]))
as.vector(predict(lm(dN.dS[k!=0] ~ 1/k[k!=0] + rsa[k!=0])))
source('~/Desktop/hiv/hiv_structure/predictors/calc_correlations.R')
source('~/Desktop/hiv/hiv_structure/predictors/calc_correlations.R')
predict(lm(dN.dS[x!=0] ~ 1/x[x!=0])
)
predict(lm(dN.dS[distances[1,]!=0] ~ 1/distances[1,][distances[1,]!=0])
)
predict(lm(dN.dS[distances[1,]!=0] ~ 1/distances[1,][distances[1,]!=0]))
lm(distances[1[]])
lm(distances[1)
lm(distances[1])
lm(distances[1,])
lm(distances[,1])
distances[1,]
distances[,1]
lm(dN.dS[distances[,1] != 0] ~ distances[distances[,1] != 0])
lm(dN.dS[distances[,1] != 0] ~ distances[,1][distances[,1] != 0])
a=lm(dN.dS[distances[,1] != 0] ~ distances[,1][distances[,1] != 0])
summary(a)
a=lm(dN.dS[distances[,1] != 0] ~ 1/distances[,1][distances[,1] != 0])
summary(a)
summary(a)
a=lm(dN.dS[distances[,1] != 0] ~ I(1/distances[,1][distances[,1] != 0])
)
a=lm(dN.dS[distances[,1] != 0] ~ I(1/distances[,1][distances[,1] != 0])
)
a=lm(dN.dS[distances[,1] != 0] ~ I(1/distances[,1][distances[,1] != 0]))
summary(a)
source('~/Desktop/hiv/hiv_structure/predictors/calc_correlations.R')
source('~/Desktop/hiv/hiv_structure/predictors/calc_correlations.R')
source('~/Desktop/hiv/hiv_structure/predictors/calc_correlations.R')
source('~/Desktop/hiv/hiv_structure/predictors/calc_correlations.R')
0.5758554^2
source('~/Desktop/hiv/hiv_structure/predictors/calc_correlations.R')
source('~/Desktop/hiv/hiv_structure/predictors/calc_correlations.R')
source('~/Desktop/hiv/hiv_structure/predictors/calc_correlations.R')
lm(dN.dS ~ rsa)
a <- lm(dN.dS ~ rsa)
summary(a)
source('~/Desktop/hiv/hiv_structure/predictors/calc_correlations.R')
source('~/Desktop/hiv/hiv_structure/predictors/calc_correlations.R')
source('~/Desktop/hiv/hiv_structure/predictors/calc_correlations.R')
source('~/Desktop/hiv/hiv_structure/predictors/calc_correlations.R')
source('~/Desktop/hiv/hiv_structure/predictors/calc_correlations.R')
source('~/Desktop/hiv/hiv_structure/predictors/calc_correlations.R')
source('~/Desktop/hiv/hiv_structure/predictors/calc_correlations.R')
source('~/Desktop/hiv/hiv_structure/predictors/calc_correlations.R')
source('~/Desktop/hiv/hiv_structure/predictors/calc_correlations.R')
source('~/Desktop/hiv/hiv_structure/predictors/calc_correlations.R')
source('~/Desktop/hiv/hiv_structure/predictors/calc_correlations.R')
source('~/Google Drive/Documents/PostDoc/HIVStructuralDeterminants/hiv_structural_determinants-paper-now/data/gp120/gp120_structure/predictors/calc_correlations.R')
map
source('~/Google Drive/Documents/PostDoc/HIVStructuralDeterminants/hiv_structural_determinants-paper-now/data/gp120/gp120_structure/predictors/calc_correlations.R')
dN.dS
rates
source('~/Google Drive/Documents/PostDoc/HIVStructuralDeterminants/hiv_structural_determinants-paper-now/data/gp120/gp120_structure/predictors/calc_correlations.R')
rates
rm(list = ls())
rates <- read.table('sites.dat', head=T, sep=',', stringsAsFactors=F)
rsa <- read.table('4TVP_trimer.rsa', head=T, stringsAsFactors=F)$RSA
distances <- read.table('4TVP_monomer_distances.dat', head=F, sep=',', stringsAsFactors=T)
map <- read.table('aas.fasta.map', head=F, stringsAsFactors=F)
dN.dS <- rates$dNdS[map$V3 != '-']
dN.dS
rates
source('~/Google Drive/Documents/PostDoc/HIVStructuralDeterminants/hiv_structural_determinants-paper-now/data/gp120/gp120_structure/predictors/calc_correlations.R')
dN.dS
dim(distances)
length(dN.dS)
map
dN.dS <- rates$dN.dS[map$V3]
dN.dS
map$V3
dN.dS <- rates$dN.dS[as.numeric(map$V3)]
as.numeric(map$V3)
dN.dS
rm(list = ls())
rates <- read.table('sites.dat', head=T, sep=',', stringsAsFactors=F)
rsa <- read.table('4TVP_trimer.rsa', head=T, stringsAsFactors=F)$RSA
distances <- read.table('4TVP_monomer_distances.dat', head=F, sep=',', stringsAsFactors=T)
map <- read.table('aas.fasta.map', head=F, stringsAsFactors=F)
sites <- as.numeric(map$V3)
sites <- sites[!is.na(sites)]
dN.dS <- rates$dN.dS[sites]
dN.dS
map$V3
map
source('~/Google Drive/Documents/PostDoc/HIVStructuralDeterminants/hiv_structural_determinants-paper-now/data/gp120/gp120_structure/predictors/calc_correlations.R')
sites
source('~/Google Drive/Documents/PostDoc/HIVStructuralDeterminants/hiv_structural_determinants-paper-now/data/gp120/gp120_structure/predictors/calc_correlations.R')
dN.dS
map$V1
source('~/Google Drive/Documents/PostDoc/HIVStructuralDeterminants/hiv_structural_determinants-paper-now/data/gp120/gp120_structure/predictors/calc_correlations.R')
dN.dS
length(dN.dS)
dim distances
dim(distances)
source('~/Google Drive/Documents/PostDoc/HIVStructuralDeterminants/hiv_structural_determinants-paper-now/data/gp120/gp120_structure/predictors/calc_correlations.R')
dim(map)
length(dN.dS)
map$aa!='-'
sum(map$aa!='-')
dim(rates)
source('~/Google Drive/Documents/PostDoc/HIVStructuralDeterminants/hiv_structural_determinants-paper-now/data/gp120/gp120_structure/predictors/calc_correlations.R')
dim(map)
dim(rates)
source('~/Google Drive/Documents/PostDoc/HIVStructuralDeterminants/hiv_structural_determinants-paper-now/data/gp120/gp120_structure/predictors/calc_correlations.R')
dim(map)
dim(rates)
source('~/Google Drive/Documents/PostDoc/HIVStructuralDeterminants/hiv_structural_determinants-paper-now/data/gp120/gp120_structure/predictors/calc_correlations.R')
dim(map)
source('~/Google Drive/Documents/PostDoc/HIVStructuralDeterminants/hiv_structural_determinants-paper-now/data/gp120/gp120_structure/predictors/calc_correlations.R')
dim(map)
getwd()
rm(list = ls())
rates <- read.table('sites.dat', head=T, sep=',', stringsAsFactors=F)
rsa <- read.table('1HPV_dimer.rsa', head=T, stringsAsFactors=F)$RSA
distances <- read.table('distances.dat', head=F, sep=',', stringsAsFactors=T)
map <- read.table('aas.fasta.map', head=T, stringsAsFactors=F)
dN.dS <- rates$dN.dS[map$aa != '-']
rates <- read.table('sites.dat', head=T, sep=',', stringsAsFactors=F)
rsa <- read.table('1HPV_dimer.rsa', head=T, stringsAsFactors=F)$RSA
distances <- read.table('distances.dat', head=F, sep=',', stringsAsFactors=T)
map <- read.table('aas.fasta.map', head=T, stringsAsFactors=F)
dN.dS <- rates$dN.dS[map$V3]
rates <- read.table('sites.dat', head=T, sep=',', stringsAsFactors=F)
